---
tags: pattern, pattern/function, factorio, code-logic, project/DOOM, pattern/variant/simple
date: 2025-04-25
pattern_type: function
pattern_variant: simple
source_file: r_main.c
line: 544
project: DOOM
first_seen: 2025-04-25
occurrences: 1
ai_analyzed: non
optimizable: non
---

# üè≠ Usine modulaire (FUNCTION) (Simple)

## Contexte
- **Fichier**: `r_main.c`
- **Ligne**: 544
- **Fonction**: R_InitTextureMapping
- **Projet**: DOOM
- **Variante**: Simple
- **Complexit√©**: standard

## M√©taphore Factorio
üè≠ **Usine modulaire**

Comme une usine qui prend des entr√©es, effectue un traitement, et produit des sorties.

## Code Source
```c
void R_InitTextureMapping (void)
{
    int			i;
    int			x;
    int			t;
    fixed_t		focallength;
    
    // Use tangent table to generate viewangletox:
    //  viewangletox will give the next greatest x
    //  after the view angle.
    //
    // Calc focallength
    //  so FIELDOFVIEW angles covers SCREENWIDTH.
    focallength = FixedDiv (centerxfrac,
			    finetangent[FINEANGLES/4+FIELDOFVIEW/2] );
	
    for (i=0 ; i<FINEANGLES/2 ; i++)
    {
	if (finetangent[i] > FRACUNIT*2)
	    t = -1;
	else if (finetangent[i] < -FRACUNIT*2)
	    t = viewwidth+1;
	else
	{
	    t = FixedMul (finetangent[i], focallength);
	    t = (centerxfrac - t+FRACUNIT-1)>>FRACBITS;

	    if (t < -1)
		t = -1;
	    else if (t>viewwidth+1)
		t = viewwidth+1;
	}
	viewangletox[i] = t;
    }
    
    // Scan viewangletox[] to generate xtoviewangle[]:
    //  xtoviewangle will give the smallest view angle
    //  that maps to x.	
    for (x=0;x<=viewwidth;x++)
    {
	i = 0;
	while (viewangletox[i]>x)
	    i++;
	xtoviewangle[x] = (i<<ANGLETOFINESHIFT)-ANG90;
    }
    
    // Take out the fencepost cases from viewangletox.
    for (i=0 ; i<FINEANGLES/2 ; i++)
    {
	t = FixedMul (finetangent[i], focallength);
	t = centerx - t;
	
	if (viewangletox[i] == -1)
	    viewangletox[i] = 0;
	else if (viewangletox[i] == viewwidth+1)
	    viewangletox[i]  = viewwidth;
    }
	
    clipangle = xtoviewangle[0];
}
```

## Note Factorio-style
*Ce pattern fonctionne comme usine modulaire dans Factorio. Il comme une usine qui prend des entr√©es, effectue un traitement, et produit des sorties.*

## Patterns Similaires
- [[function_DOOM_2a88c198|p_doors.c:566]] (P_InitSlidingDoorFrames)
- [[function_DOOM_c34377e0|i_video.c:930]] (InitExpand2)
- [[function_DOOM_e077dfd4|r_data.c:633]] (R_InitColormaps)
- [[function_DOOM_c32b2fdf|r_main.c:612]] (R_InitLightTables)
- [[function_DOOM_34afef29|r_plane.c:185]] (R_ClearPlanes)

## Note Perso
*Ajouter vos notes personnelles ici...*

## Statistiques du Pattern
- **Premi√®re d√©tection**: 2025-04-25
- **Derni√®re mise √† jour**: 2025-04-25
- **Nombre d'occurrences**: 1 fichiers
- **Analys√© par IA**: Non
- **Optimisable**: Non

## Patterns li√©s
[[return_DOOM_3e1b4f0f|üöö Convoyeur de sortie (RETURN)]]
[[return_DOOM_e198b61b|üöö Convoyeur de sortie (RETURN)]]
[[return_DOOM_e198b61b|üöö Convoyeur de sortie (RETURN)]]
